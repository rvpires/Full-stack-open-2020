{"ast":null,"code":"/* eslint-disable no-case-declarations */\nimport blogService from '../services/blogs';\nimport { setNotification } from './notificationReducer';\n\nconst sortBlogs = blogs => {\n  const orderFunction = (a, b) => {\n    if (a.likes > b.likes) {\n      return -1;\n    }\n\n    if (a.likes < b.likes) {\n      return 1;\n    }\n\n    return 0;\n  };\n\n  return blogs.sort(orderFunction);\n};\n\nconst blogReducer = (state = [], action) => {\n  console.log('state', state);\n\n  switch (action.type) {\n    case 'INIT':\n      return action.data.blogs;\n\n    case 'UPDATE':\n      let newBlogs = state.filter(blog => blog.id !== action.data.newBlog.id);\n      return sortBlogs(newBlogs.concat(action.data.newBlog));\n\n    case 'DELETE':\n      return state.filter(blog => blog.id !== action.data.blog.id);\n\n    case 'ADD':\n      return sortBlogs([...state, action.data.newBlog]);\n\n    default:\n      return state;\n  }\n};\n\nexport const initBlogs = () => {\n  return async dispatch => {\n    const blogs = await blogService.getAll();\n    dispatch({\n      type: 'INIT',\n      data: {\n        blogs: sortBlogs(blogs)\n      }\n    });\n  };\n};\nexport const updateBlog = blog => {\n  return async dispatch => {\n    try {\n      const newBlog = await blogService.update(blog);\n      dispatch({\n        type: 'UPDATE',\n        data: {\n          newBlog\n        }\n      });\n      dispatch(setNotification(`${newBlog.title} by ${newBlog.author} updated successfuly.`, 5, 'success'));\n    } catch (exception) {\n      dispatch(setNotification('Could not update blog.', 5, 'error'));\n    }\n\n    const newBlog = await blogService.update(blog);\n    dispatch({\n      type: 'UPDATE',\n      data: {\n        newBlog\n      }\n    });\n  };\n};\nexport const deleteBlog = (blog, user) => {\n  return async dispatch => {\n    try {\n      blogService.setToken(user.token);\n      await blogService.deleteBlog(blog);\n      dispatch({\n        type: 'DELETE',\n        data: {\n          blog\n        }\n      });\n      dispatch(setNotification(`${blog.title} by ${blog.author} deleted successfuly.`, 5, 'success'));\n    } catch (exception) {\n      dispatch(setNotification('Could not delete blog.', 5, 'error'));\n    }\n  };\n};\nexport const addBlog = (blog, user) => {\n  return async dispatch => {\n    try {\n      blogService.setToken(user.token);\n      const newBlog = await blogService.create(blog);\n      dispatch({\n        type: 'ADD',\n        data: {\n          newBlog\n        }\n      });\n      dispatch(setNotification(`${newBlog.title} by ${newBlog.author} added successfuly.`, 5, 'success'));\n    } catch (exception) {\n      dispatch(setNotification('Could not add blog.', 5, 'error'));\n    }\n  };\n};\nexport default blogReducer;","map":{"version":3,"sources":["/home/rvp/Desktop/Full-stack-open-2020/part7/blog/client/src/reducers/blogReducer.js"],"names":["blogService","setNotification","sortBlogs","blogs","orderFunction","a","b","likes","sort","blogReducer","state","action","console","log","type","data","newBlogs","filter","blog","id","newBlog","concat","initBlogs","dispatch","getAll","updateBlog","update","title","author","exception","deleteBlog","user","setToken","token","addBlog","create"],"mappings":"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","sourcesContent":["/* eslint-disable no-case-declarations */\nimport blogService from '../services/blogs'\nimport { setNotification } from './notificationReducer'\nconst sortBlogs = blogs => {\n\n\tconst orderFunction = (a, b) => {\n\t\tif (a.likes > b.likes) {\n\t\t\treturn -1\n\t\t}\n\t\tif (a.likes < b.likes) {\n\t\t\treturn 1\n\t\t}\n\n\t\treturn 0\n\t}\n\n\treturn (blogs.sort(orderFunction))\n}\n\nconst blogReducer = (state = [], action) => {\n\n\tconsole.log('state', state)\n\n\tswitch (action.type) {\n\n\tcase 'INIT':\n\t\treturn action.data.blogs\n\n\tcase 'UPDATE':\n\t\tlet newBlogs = state.filter(blog => blog.id !== action.data.newBlog.id)\n\t\treturn sortBlogs(newBlogs.concat(action.data.newBlog))\n\n\tcase 'DELETE':\n\t\treturn state.filter(blog => blog.id !== action.data.blog.id)\n\n\tcase 'ADD':\n\n\t\treturn sortBlogs([...state, action.data.newBlog])\n\n\tdefault:\n\t\treturn state\n\n\t}\n}\n\n\nexport const initBlogs = () => {\n\treturn async dispatch => {\n\n\t\tconst blogs = await blogService.getAll()\n\t\tdispatch(({ type: 'INIT', data: { blogs: sortBlogs(blogs) } }))\n\t}\n}\n\nexport const updateBlog = (blog) => {\n\treturn async dispatch => {\n\n\t\ttry\n\t\t{\n\t\t\tconst newBlog = await blogService.update(blog)\n\t\t\tdispatch({ type: 'UPDATE', data: { newBlog } })\n\t\t\tdispatch(setNotification(`${newBlog.title} by ${newBlog.author} updated successfuly.`, 5, 'success'))\n\n\n\t\t}\n\t\tcatch (exception)\n\t\t{\n\t\t\tdispatch(setNotification('Could not update blog.' , 5, 'error'))\n\t\t}\n\t\tconst newBlog = await blogService.update(blog)\n\t\tdispatch({ type: 'UPDATE', data: { newBlog } })\n\t}\n\n}\n\nexport const deleteBlog = (blog, user) => {\n\treturn async dispatch => {\n\n\t\ttry\n\t\t{\n\t\t\tblogService.setToken(user.token)\n\t\t\tawait blogService.deleteBlog(blog)\n\t\t\tdispatch({ type: 'DELETE', data: { blog } })\n\t\t\tdispatch(setNotification(`${blog.title} by ${blog.author} deleted successfuly.`, 5, 'success'))\n\n\n\t\t}\n\t\tcatch(exception)\n\t\t{\n\t\t\tdispatch(setNotification('Could not delete blog.' , 5, 'error'))\n\t\t}\n\n\n\t}\n}\n\nexport const addBlog = (blog, user) => {\n\treturn async dispatch => {\n\n\t\ttry\n\t\t{\n\t\t\tblogService.setToken(user.token)\n\t\t\tconst newBlog = await blogService.create(blog)\n\t\t\tdispatch({ type: 'ADD', data: { newBlog } })\n\t\t\tdispatch(setNotification(`${newBlog.title} by ${newBlog.author} added successfuly.`, 5, 'success'))\n\n\n\t\t}\n\t\tcatch(exception)\n\t\t{\n\t\t\tdispatch(setNotification('Could not add blog.' , 5, 'error'))\n\t\t}\n\t\t\n\t}\n}\n\nexport default blogReducer\n"]},"metadata":{},"sourceType":"module"}